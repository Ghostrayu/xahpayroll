# XAH PAYROLL - WEB APP

## OVERVIEW

XAH PAYROLL IS A DECENTRALIZED PAYROLL MANAGEMENT SYSTEM THAT ENABLES HOURLY WAGE PAYMENTS THROUGH XAH MICROTRANSACTIONS. THE SYSTEM USES PAYMENT CHANNEL HOOKS TO VERIFY NGO INPUTS, MANAGES ESCROWED XAH FUNDS, AND AUTOMATICALLY DISTRIBUTES HOURLY PAYMENTS WITH BUILT-IN TIMEOUT MECHANISMS.

## CORE FEATURES

### CORE FUNCTIONALITY
- **HOURLY AUTOMATIC PAYMENTS**: WORKERS RECEIVE XAH DIRECTLY TO THEIR WALLETS EVERY HOUR
- **REAL-TIME TRACKING**: LIVE MONITORING OF WORK HOURS AND PAYMENT STATUS
- **WORKER MANAGEMENT**: ADD WORKERS WITH XAMAN QR CODE SCANNING FOR EASY ONBOARDING
- **ESCROW MANAGEMENT**: SECURE FUND HOLDING WITH TRANSPARENT BALANCE TRACKING
- **XRPL HOOKS INTEGRATION**: AUTOMATED PAYMENT VERIFICATION AND PROCESSING
- **MULTI-ROLE SUPPORT**: SEPARATE INTERFACES FOR WORKERS, NGOS, AND EMPLOYERS
- **MULTI-WALLET SUPPORT**: CONNECT WITH XAMAN (XUMM), CROSSMARK, OR GEMWALLET

### üïê HOURLY PAYMENT DISTRIBUTION
- **AUTOMATED HOURLY PAYOUTS**: WORKERS RECEIVE XAH PAYMENTS AUTOMATICALLY EVERY HOUR BASED ON LOGGED WORK TIME
- **MICROTRANSACTION EFFICIENCY**: LEVERAGES XAH PAYMENT CHANNELS FOR LOW-COST, HIGH-FREQUENCY PAYMENTS
- **REAL-TIME TRACKING**: LIVE MONITORING OF HOURS LOGGED AND PAYMENTS PROCESSED

### üîê PAYMENT CHANNEL HOOKS
- **NGO INPUT VERIFICATION**: CRYPTOGRAPHIC VERIFICATION OF EMPLOYER/NGO INPUTS BEFORE PAYMENT PROCESSING
- **HOOK-BASED VALIDATION**: SMART CONTRACT HOOKS VALIDATE WORK LOGS AND PAYMENT CONDITIONS
- **TAMPER-PROOF RECORDS**: IMMUTABLE ON-CHAIN VERIFICATION OF ALL TRANSACTIONS

### üí∞ ESCROW MANAGEMENT
- **SECURE FUND HOLDING**: EMPLOYER FUNDS HELD IN ESCROW UNTIL HOURLY PAYMENT CONDITIONS ARE MET
- **AUTOMATED RELEASE**: PAYMENTS AUTOMATICALLY RELEASED FROM ESCROW ON HOURLY INTERVALS
- **BALANCE MONITORING**: REAL-TIME ESCROW BALANCE TRACKING AND LOW-BALANCE ALERTS

### ‚è±Ô∏è AUTOMATED TIMEOUT SYSTEM
- **INACTIVITY DETECTION**: AUTOMATIC TIMEOUT WHEN WORKERS STOP LOGGING HOURS
- **GRACE PERIODS**: CONFIGURABLE TIMEOUT THRESHOLDS BEFORE PAYMENT SUSPENSION
- **SESSION MANAGEMENT**: CLEAN SESSION TERMINATION AND ESCROW FUND RETURN ON TIMEOUT

## TECHNICAL ARCHITECTURE

### PAYMENT FLOW
```
1. NGO/EMPLOYER DEPOSITS XAH INTO ESCROW
2. WORKER STARTS LOGGING HOURS VIA WEB INTERFACE
3. PAYMENT CHANNEL HOOK VERIFIES WORKER ACTIVITY
4. HOURLY TIMER TRIGGERS PAYMENT RELEASE
5. XAH TRANSFERRED FROM ESCROW TO WORKER WALLET
6. TIMEOUT MONITOR CHECKS FOR INACTIVITY
7. SESSION ENDS ON TIMEOUT OR MANUAL STOP
```

### TECHNOLOGY STACK
- **BLOCKCHAIN**: XAH LEDGER (XRPL)
- **SMART CONTRACTS**: PAYMENT CHANNEL HOOKS
- **FRONTEND**: REACT.JS WITH WEB3 INTEGRATION
- **BACKEND**: NODE.JS WITH XRPL SDK
- **DATABASE**: POSTGRESQL FOR OFF-CHAIN RECORDS
- **AUTHENTICATION**: WALLET-BASED AUTHENTICATION

## KEY COMPONENTS

### 1. WORKER INTERFACE
- CLOCK IN/OUT FUNCTIONALITY
- REAL-TIME HOURS TRACKER
- PAYMENT HISTORY DASHBOARD
- WALLET CONNECTION AND BALANCE DISPLAY

### 2. EMPLOYER/NGO DASHBOARD
- **WORKER MANAGEMENT**: ADD WORKERS WITH XAMAN QR CODE SCANNING OR MANUAL ENTRY
- **WORKER DROPDOWN**: SELECT WORKERS FROM DROPDOWN WHEN CREATING PAYMENT CHANNELS
- **ESCROW FUNDING INTERFACE**: FUND PAYMENT CHANNELS WITH XAH
- **PAYMENT ANALYTICS AND REPORTS**: MONITOR ACTIVE CHANNELS AND WORKER STATUS
- **HOOK CONFIGURATION PANEL**: CONFIGURE PAYMENT CHANNEL SETTINGS

### 3. PAYMENT CHANNEL SYSTEM
- MULTI-SIGNATURE PAYMENT CHANNELS
- HOOK-BASED VALIDATION LOGIC
- AUTOMATIC SETTLEMENT ON TIMEOUT
- CHANNEL STATE MANAGEMENT

### 4. VERIFICATION HOOKS
- **INPUT VALIDATION HOOK**: VERIFIES NGO AUTHORIZATION SIGNATURES
- **TIME VERIFICATION HOOK**: VALIDATES WORK HOUR SUBMISSIONS
- **PAYMENT AUTHORIZATION HOOK**: CONFIRMS ESCROW AVAILABILITY BEFORE RELEASE
- **TIMEOUT HOOK**: TRIGGERS AUTOMATIC SESSION TERMINATION

## SECURITY FEATURES

- **MULTI-SIGNATURE ESCROW**: REQUIRES BOTH EMPLOYER AND SYSTEM SIGNATURES FOR FUND MANAGEMENT
- **RATE LIMITING**: PREVENTS SPAM AND FRAUDULENT HOUR LOGGING
- **AUDIT TRAIL**: COMPLETE TRANSACTION HISTORY ON-CHAIN
- **ENCRYPTED COMMUNICATIONS**: ALL API CALLS SECURED WITH TLS
- **WALLET SECURITY**: NON-CUSTODIAL DESIGN - USERS MAINTAIN CONTROL OF PRIVATE KEYS

## SETUP & INSTALLATION

### PREREQUISITES
```bash
- NODE.JS V18+
- POSTGRESQL 14+
- XRPL TESTNET/MAINNET ACCESS
- WEB3 WALLET (E.G., XUMM, CROSSMARK)
```

### INSTALLATION
```bash
# CLONE REPOSITORY
GIT CLONE HTTPS://GITHUB.COM/YOUR-ORG/XAH-PAYROLL.GIT
CD XAH-PAYROLL

# INSTALL ALL DEPENDENCIES (ROOT, FRONTEND, AND BACKEND)
NPM RUN INSTALL:ALL

# CONFIGURE ENVIRONMENT VARIABLES
# FRONTEND
CP FRONTEND/.ENV.EXAMPLE FRONTEND/.ENV
# EDIT FRONTEND/.ENV WITH BACKEND URL AND NETWORK CONFIGURATION

# BACKEND
CP BACKEND/.ENV.EXAMPLE BACKEND/.ENV
# EDIT BACKEND/.ENV WITH YOUR XAMAN API CREDENTIALS AND DATABASE SETTINGS

# START BOTH SERVERS (BACKEND + FRONTEND)
NPM RUN DEV
```

### NETWORK CONFIGURATION

**SWITCH BETWEEN TESTNET AND MAINNET:**

EDIT `FRONTEND/.ENV` AND CHANGE THE NETWORK VARIABLE:

```ENV
# FOR MAINNET (PRODUCTION)
VITE_XRPL_NETWORK=MAINNET

# FOR TESTNET (DEVELOPMENT/TESTING)
VITE_XRPL_NETWORK=TESTNET
```

**IMPORTANT:** RESTART THE DEV SERVER AFTER CHANGING THE NETWORK.

SEE [NETWORK_CONFIG.MD](./NETWORK_CONFIG.MD) FOR DETAILED NETWORK SWITCHING INSTRUCTIONS.

### DEVELOPMENT COMMANDS

```bash
# START BOTH BACKEND AND FRONTEND SERVERS
NPM RUN DEV

# START BACKEND ONLY
NPM RUN DEV:BACKEND

# START FRONTEND ONLY
NPM RUN DEV:FRONTEND

# INSTALL ALL DEPENDENCIES
NPM RUN INSTALL:ALL

# BUILD FRONTEND FOR PRODUCTION
NPM RUN BUILD

# RUN LINTER
NPM RUN LINT
```

### SERVER URLS
- **FRONTEND**: HTTP://LOCALHOST:3000 (OPENS AUTOMATICALLY)
- **BACKEND API**: HTTP://LOCALHOST:3001
- **HEALTH CHECK**: HTTP://LOCALHOST:3001/HEALTH

### ENVIRONMENT VARIABLES
```env
XRPL_NETWORK=TESTNET
XRPL_WEBHOOK_URL=YOUR_WEBHOOK_URL
DATABASE_URL=POSTGRESQL://USER:PASSWORD@LOCALHOST:5432/XAHPAYROLL
ESCROW_WALLET_SEED=YOUR_ESCROW_WALLET_SEED
PAYMENT_INTERVAL_MINUTES=60
TIMEOUT_THRESHOLD_MINUTES=15
```

## USAGE

### ‚ö†Ô∏è IMPORTANT: WALLET ADDRESS RESTRICTIONS
**A WALLET ADDRESS CAN ONLY BE REGISTERED AS EITHER AN EMPLOYEE OR AN NGO/EMPLOYER, NOT BOTH.**
- IF YOUR WALLET IS REGISTERED AS AN EMPLOYEE, YOU CANNOT USE IT FOR AN NGO/EMPLOYER ACCOUNT
- IF YOUR WALLET IS REGISTERED AS AN NGO/EMPLOYER, YOU CANNOT USE IT FOR AN EMPLOYEE ACCOUNT
- USE SEPARATE WALLET ADDRESSES FOR DIFFERENT ACCOUNT TYPES

### FOR WORKERS
1. CONNECT YOUR XAH WALLET TO THE PLATFORM
2. COMPLETE YOUR PROFILE (DISPLAY NAME, EMAIL, ETC.)
3. ACCEPT THE TERMS OF SERVICE
4. CLICK "START SHIFT" TO BEGIN LOGGING HOURS
5. WORK IS AUTOMATICALLY TRACKED AND VERIFIED VIA HOOKS
6. RECEIVE XAH PAYMENTS EVERY HOUR TO YOUR WALLET
7. CLICK "END SHIFT" WHEN DONE, OR AUTOMATIC TIMEOUT AFTER INACTIVITY

### FOR EMPLOYERS/NGOS
1. CONNECT YOUR XRPL WALLET TO THE PLATFORM (MUST BE DIFFERENT FROM ANY EMPLOYEE WALLET)
2. COMPLETE YOUR ORGANIZATION PROFILE
3. ACCEPT THE TERMS OF SERVICE
4. **ADD WORKERS TO YOUR ORGANIZATION**:
   - CLICK "ADD WORKER" BUTTON ON DASHBOARD
   - OPTION 1: USE "SCAN WITH XAMAN" TO SCAN WORKER'S QR CODE (RECOMMENDED)
   - OPTION 2: MANUALLY ENTER WORKER NAME AND WALLET ADDRESS
   - WORKERS MUST BE ADDED BEFORE CREATING PAYMENT CHANNELS
5. **CREATE PAYMENT CHANNEL**:
   - SELECT WORKER FROM DROPDOWN (SHOWS ALL ADDED WORKERS)
   - CONFIGURE JOB NAME, HOURLY RATE, AND DURATION
   - FUND ESCROW WITH XAH
   - WORKER'S WALLET ADDRESS DISPLAYED BELOW DROPDOWN FOR VERIFICATION
6. USE NGO DASHBOARD TO MONITOR REAL-TIME PAYMENT ACTIVITY, ESCROW BALANCE, REVIEW PAYMENT REPORTS, AND ANALYTICS.

## WORKER MANAGEMENT WORKFLOW

### ADDING WORKERS TO YOUR ORGANIZATION

**STEP 1: ADD WORKER**
- CLICK "ADD WORKER" BUTTON ON NGO DASHBOARD
- CHOOSE ONE OF TWO OPTIONS:
  1. **SCAN WITH XAMAN** (RECOMMENDED):
     - CLICK "SCAN WITH XAMAN" BUTTON
     - QR CODE APPEARS ON SCREEN
     - WORKER SCANS QR CODE WITH XAMAN WALLET
     - WALLET ADDRESS AUTO-FILLS WHEN WORKER APPROVES
  2. **MANUAL ENTRY**:
     - ENTER WORKER NAME
     - ENTER WORKER'S XRPL WALLET ADDRESS (STARTS WITH 'R')
- CLICK "ADD WORKER"
- WORKER IS NOW ADDED TO YOUR ORGANIZATION

**STEP 2: CREATE PAYMENT CHANNEL**
- CLICK "CREATE PAYMENT CHANNEL" BUTTON
- SELECT WORKER FROM DROPDOWN (SHOWS ALL ADDED WORKERS)
- WORKER'S WALLET ADDRESS DISPLAYS BELOW DROPDOWN FOR VERIFICATION
- CONFIGURE JOB DETAILS (NAME, HOURLY RATE, DURATION)
- FUND WITH XAH
- SIGN TRANSACTION WITH YOUR WALLET

**KEY FEATURES:**
- ‚úÖ SAME WORKER CAN WORK FOR MULTIPLE ORGANIZATIONS
- ‚úÖ SAME WORKER CAN HAVE MULTIPLE PAYMENT CHANNELS (DIFFERENT JOBS)
- ‚úÖ WORKER ADDRESSES VALIDATED AUTOMATICALLY
- ‚úÖ PREVENTS NGO/EMPLOYER WALLETS FROM BEING ADDED AS WORKERS
- ‚úÖ QR CODE SCANNING ELIMINATES ADDRESS ENTRY ERRORS

## PAYMENT CHANNEL CONFIGURATION

### CREATING A PAYMENT CHANNEL
```javascript
CONST PAYMENTCHANNEL = AWAIT XRPL.CREATEPAYMENTCHANNEL({
  ACCOUNT: EMPLOYERWALLET,
  DESTINATION: WORKERWALLET,
  AMOUNT: ESCROWAMOUNT,
  SETTLEDELAY: 3600, // 1 HOUR IN SECONDS
  PUBLICKEY: HOOKPUBLICKEY
});
```

### HOOK VERIFICATION LOGIC
```javascript
// PSEUDO-CODE FOR NGO INPUT VERIFICATION HOOK
FUNCTION VERIFYNGOINPUT(TRANSACTION) {
  CONST NGOSIGNATURE = TRANSACTION.MEMOS.NGOSIGNATURE;
  CONST ISVALID = CRYPTOVERIFY(NGOSIGNATURE, NGOPUBLICKEY);
  
  IF (!ISVALID) {
    RETURN HOOK_REJECT;
  }
  
  RETURN HOOK_ACCEPT;
}
```

## TIMEOUT MECHANISM

### AUTOMATIC TIMEOUT FLOW
- **INACTIVITY THRESHOLD**: 15 MINUTES (CONFIGURABLE)
- **WARNING**: USER RECEIVES NOTIFICATION AT 10 MINUTES OF INACTIVITY
- **TIMEOUT ACTION**: SESSION TERMINATED, FINAL PAYMENT CALCULATED AND RELEASED
- **ESCROW RETURN**: UNUSED ESCROW FUNDS RETURNED TO EMPLOYER

### MANUAL OVERRIDE
EMPLOYERS CAN MANUALLY END SESSIONS OR ADJUST TIMEOUT SETTINGS PER WORKER.

## API ENDPOINTS

### WORKER MANAGEMENT ENDPOINTS
- `POST /API/WORKERS/ADD` - ADD WORKER TO ORGANIZATION
- `GET /API/WORKERS/LIST/:NGOWALLET` - LIST ALL WORKERS FOR ORGANIZATION

### WORKER ENDPOINTS
- `POST /API/WORKERS/CLOCK-IN` - START LOGGING HOURS
- `POST /API/WORKERS/CLOCK-OUT` - STOP LOGGING HOURS
- `GET /API/WORKERS/EARNINGS/:WALLET` - GET WORKER EARNINGS
- `GET /API/WORKERS/SESSIONS/:WALLET` - GET WORK SESSIONS

### ORGANIZATION ENDPOINTS
- `GET /API/ORGANIZATIONS/STATS/:WALLET` - GET ORGANIZATION STATISTICS
- `GET /API/ORGANIZATIONS/WORKERS/:WALLET` - GET ORGANIZATION WORKERS
- `GET /API/ORGANIZATIONS/ACTIVITY/:WALLET` - GET RECENT ACTIVITY
- `GET /API/ORGANIZATIONS/PAYMENT-CHANNELS/:WALLET` - GET PAYMENT CHANNELS

### PAYMENT CHANNEL ENDPOINTS
- `POST /API/PAYMENT-CHANNELS/CREATE` - CREATE NEW PAYMENT CHANNEL
- `POST /API/PAYMENT-CHANNELS/:CHANNELID/CLOSE` - CLOSE PAYMENT CHANNEL

### XAMAN INTEGRATION ENDPOINTS
- `POST /API/XAMAN/CREATE-SIGNIN` - CREATE XAMAN QR CODE FOR SIGN-IN
- `GET /API/XAMAN/PAYLOAD/:UUID` - GET XAMAN PAYLOAD STATUS
- `POST /API/XAMAN/CANCEL/:UUID` - CANCEL XAMAN PAYLOAD

### HOOK ENDPOINTS
- `POST /API/HOOKS/VERIFY-INPUT` - VERIFY NGO INPUT SIGNATURE
- `POST /API/HOOKS/VALIDATE-TIME` - VALIDATE WORK HOURS
- `POST /API/HOOKS/CHECK-TIMEOUT` - CHECK FOR SESSION TIMEOUT

## ROADMAP

- [ ] MULTI-CURRENCY SUPPORT (XRP, USD STABLECOINS)
- [ ] MOBILE APP (IOS/ANDROID)
- [ ] BIOMETRIC VERIFICATION FOR CLOCK IN/OUT
- [ ] INTEGRATION WITH TRADITIONAL PAYROLL SYSTEMS
- [ ] ADVANCED ANALYTICS AND REPORTING
- [ ] DAO GOVERNANCE FOR PLATFORM PARAMETERS
- [ ] MULTI-CHAIN SUPPORT (ETHEREUM, POLYGON)

## SECURITY

### ‚ö†Ô∏è IMPORTANT SECURITY NOTES

**NEVER COMMIT SENSITIVE DATA TO VERSION CONTROL:**
- Database passwords
- API keys
- Private keys or wallet secrets
- `.env` files with real credentials

**BEFORE DEPLOYING:**

1. **Change Default Passwords**
   - The `setup_database.sql` file contains a placeholder password `CHANGE_THIS_PASSWORD`
   - Generate a strong password: `openssl rand -base64 32`
   - Update the password in the SQL script before running
   - Store the password securely (password manager, environment variables)

2. **Environment Variables**
   - Copy `backend/.env.example` to `backend/.env`
   - Fill in all required values with your actual credentials
   - Never commit the `.env` file to git (already in `.gitignore`)

3. **Database Security**
   - Use different passwords for development, staging, and production
   - Enable SSL connections for production databases
   - Restrict database access by IP address
   - Regularly update and rotate credentials

4. **Wallet Security**
   - Never store private keys in code or environment variables
   - Use hardware wallets or secure key management services
   - Test with testnet wallets before using real funds

**REPORTING SECURITY ISSUES:**
- Email: security@xahpayroll.io
- Do NOT open public issues for security vulnerabilities

## CONTRIBUTING

WE WELCOME CONTRIBUTIONS! PLEASE SEE [CONTRIBUTING.MD](CONTRIBUTING.MD) FOR GUIDELINES.

## LICENSE

MIT LICENSE - SEE [LICENSE](LICENSE) FILE FOR DETAILS

## SUPPORT

- **DOCUMENTATION**: [DOCS.XAHPAYROLL.IO](HTTPS://DOCS.XAHPAYROLL.IO)
- **DISCORD**: [DISCORD.GG/XAHPAYROLL](HTTPS://DISCORD.GG/XAHPAYROLL)
- **EMAIL**: SUPPORT@XAHPAYROLL.IO
- **ISSUES**: [GITHUB ISSUES](HTTPS://GITHUB.COM/YOUR-ORG/XAH-PAYROLL/ISSUES)

## ACKNOWLEDGMENTS

BUILT ON THE XRP LEDGER (XRPL) WITH SUPPORT FROM THE XRPL DEVELOPER COMMUNITY.

---

**DISCLAIMER**: THIS IS EXPERIMENTAL SOFTWARE. ALWAYS TEST THOROUGHLY ON TESTNET BEFORE DEPLOYING TO MAINNET. NOT FINANCIAL ADVICE.
